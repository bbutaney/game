// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var List = require("bs-platform/lib/js/list.js");
var Curry = require("bs-platform/lib/js/curry.js");
var Pervasives = require("bs-platform/lib/js/pervasives.js");
var Caml_format = require("bs-platform/lib/js/caml_format.js");
var CS17SetupGame$Game_new = require("./CS17SetupGame.bs.js");

function stringOfPlayer(wP) {
  if (wP) {
    return "Player 2";
  } else {
    return "Player 1";
  }
}

CS17SetupGame$Game_new.checkExpect("Player 1", "Player 1", "stringOfPlayer 1");

CS17SetupGame$Game_new.checkExpect("Player 2", "Player 2", "stringOfPlayer 2");

function transpose(bd) {
  if (!bd) {
    return Pervasives.failwith("A board cannot be 0 - dimensional.");
  }
  var match = bd.hd;
  if (match) {
    if (match.tl) {
      return {
              hd: List.map(List.hd, bd),
              tl: transpose(List.map(List.tl, bd))
            };
    } else {
      return {
              hd: List.flatten(bd),
              tl: /* [] */0
            };
    }
  } else {
    return Pervasives.failwith("A board cannot be 0 - dimensional.");
  }
}

CS17SetupGame$Game_new.checkExpectListListAlpha(transpose({
          hd: {
            hd: 1,
            tl: {
              hd: 2,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 3,
              tl: {
                hd: 4,
                tl: /* [] */0
              }
            },
            tl: /* [] */0
          }
        }), {
      hd: {
        hd: 1,
        tl: {
          hd: 3,
          tl: /* [] */0
        }
      },
      tl: {
        hd: {
          hd: 2,
          tl: {
            hd: 4,
            tl: /* [] */0
          }
        },
        tl: /* [] */0
      }
    }, "2x2");

CS17SetupGame$Game_new.checkExpectListListAlpha(transpose({
          hd: {
            hd: 1,
            tl: {
              hd: 2,
              tl: {
                hd: 3,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 4,
              tl: {
                hd: 5,
                tl: {
                  hd: 6,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 7,
                tl: {
                  hd: 8,
                  tl: {
                    hd: 9,
                    tl: /* [] */0
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), {
      hd: {
        hd: 1,
        tl: {
          hd: 4,
          tl: {
            hd: 7,
            tl: /* [] */0
          }
        }
      },
      tl: {
        hd: {
          hd: 2,
          tl: {
            hd: 5,
            tl: {
              hd: 8,
              tl: /* [] */0
            }
          }
        },
        tl: {
          hd: {
            hd: 3,
            tl: {
              hd: 6,
              tl: {
                hd: 9,
                tl: /* [] */0
              }
            }
          },
          tl: /* [] */0
        }
      }
    }, "3x3");

CS17SetupGame$Game_new.checkExpectListListAlpha(transpose({
          hd: {
            hd: 1,
            tl: /* [] */0
          },
          tl: {
            hd: {
              hd: 2,
              tl: /* [] */0
            },
            tl: /* [] */0
          }
        }), {
      hd: {
        hd: 1,
        tl: {
          hd: 2,
          tl: /* [] */0
        }
      },
      tl: /* [] */0
    }, "1x2");

function stringOfAList(lst, strOf) {
  return "[" + List.fold_right((function (a, b) {
                return Curry._1(strOf, a) + ((
                          b === "]" ? "" : ", "
                        ) + b);
              }), lst, "]");
}

CS17SetupGame$Game_new.checkExpect(stringOfAList({
          hd: 1,
          tl: {
            hd: 2,
            tl: {
              hd: 3,
              tl: /* [] */0
            }
          }
        }, (function (prim) {
            return String(prim);
          })), "[1, 2, 3]", "list of int to string");

CS17SetupGame$Game_new.checkExpect(stringOfAList(/* [] */0, (function (prim) {
            return String(prim);
          })), "[]", "empty list to string");

function makeListOfStrings(b) {
  if (b) {
    return stringOfAList(b.hd, (function (prim) {
                  return String(prim);
                })) + ("\n" + makeListOfStrings(b.tl));
  } else {
    return " ";
  }
}

function stringOfState(param) {
  return makeListOfStrings(transpose(param[0]));
}

function stringOfMove(m) {
  return String(m._0);
}

CS17SetupGame$Game_new.checkExpect(String(1), "1", "stringOfMove");

function createZeroRow(_l, _n) {
  while(true) {
    var n = _n;
    var l = _l;
    if (n <= 0) {
      return l;
    }
    _n = n - 1 | 0;
    _l = {
      hd: 0,
      tl: l
    };
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(createZeroRow(/* [] */0, 2), {
      hd: 0,
      tl: {
        hd: 0,
        tl: /* [] */0
      }
    }, "zero row of length 2");

CS17SetupGame$Game_new.checkExpect(createZeroRow(/* [] */0, 0), /* [] */0, "zero row base case");

function createEmptyBoard(_bd, _height, width) {
  while(true) {
    var height = _height;
    var bd = _bd;
    if (!(height > 0 && width > 0)) {
      return bd;
    }
    _height = height - 1 | 0;
    _bd = {
      hd: createZeroRow(/* [] */0, width),
      tl: bd
    };
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(createEmptyBoard(/* [] */0, 2, 2), {
      hd: {
        hd: 0,
        tl: {
          hd: 0,
          tl: /* [] */0
        }
      },
      tl: {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: /* [] */0
          }
        },
        tl: /* [] */0
      }
    }, "createEmptyBoard 2x2");

CS17SetupGame$Game_new.checkExpect(createEmptyBoard(/* [] */0, 0, 0), /* [] */0, "createEmptyBoard base case");

CS17SetupGame$Game_new.checkExpect(createEmptyBoard(/* [] */0, 2, 0), /* [] */0, "createEmptyBoard 2x0 case");

CS17SetupGame$Game_new.checkExpect(createEmptyBoard(/* [] */0, 0, 2), /* [] */0, "createEmptyBoard 0x2 case");

function initialState(s) {
  var boardDims = CS17SetupGame$Game_new.parseBoardDims(s);
  var boardHeight = CS17SetupGame$Game_new.getBoardHeight(boardDims);
  var boardWidth = CS17SetupGame$Game_new.getBoardWidth(boardDims);
  return [
          createEmptyBoard(/* [] */0, boardWidth, boardHeight),
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ];
}

CS17SetupGame$Game_new.checkExpect(initialState("2 3"), [
      {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: /* [] */0
          }
        }
      },
      {
        TAG: /* Ongoing */1,
        _0: /* P1 */0
      }
    ], "2 3 initial state");

CS17SetupGame$Game_new.checkExpect(initialState("0 0"), [
      /* [] */0,
      {
        TAG: /* Ongoing */1,
        _0: /* P1 */0
      }
    ], "0 0 initial state");

function getLegalCols(_board, s, _colNum) {
  while(true) {
    var colNum = _colNum;
    var board = _board;
    if (typeof s === "number") {
      return /* [] */0;
    }
    if (s.TAG === /* Win */0) {
      return /* [] */0;
    }
    if (!board) {
      return /* [] */0;
    }
    var match = board.hd;
    if (match && match.hd === 0) {
      return {
              hd: /* Move */{
                _0: colNum - 1 | 0
              },
              tl: getLegalCols(board.tl, s, colNum + 1 | 0)
            };
    }
    _colNum = colNum + 1 | 0;
    _board = board.tl;
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(getLegalCols({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }, {
          TAG: /* Ongoing */1,
          _0: /* P1 */0
        }, 1), {
      hd: /* Move */{
        _0: 2
      },
      tl: {
        hd: /* Move */{
          _0: 3
        },
        tl: /* [] */0
      }
    }, "getLegalCols 1");

CS17SetupGame$Game_new.checkExpect(getLegalCols({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }, {
          TAG: /* Ongoing */1,
          _0: /* P2 */1
        }, 1), {
      hd: /* Move */{
        _0: 2
      },
      tl: {
        hd: /* Move */{
          _0: 3
        },
        tl: /* [] */0
      }
    }, "getLegalCols 2");

CS17SetupGame$Game_new.checkExpect(getLegalCols({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }, {
          TAG: /* Win */0,
          _0: /* P1 */0
        }, 1), /* [] */0, "getLegalCols Win 1");

CS17SetupGame$Game_new.checkExpect(getLegalCols({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }, {
          TAG: /* Win */0,
          _0: /* P2 */1
        }, 1), /* [] */0, "getLegalCols Win 2");

CS17SetupGame$Game_new.checkExpect(getLegalCols({
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }, /* Draw */0, 1), /* [] */0, "getLegalCols Draw");

CS17SetupGame$Game_new.checkExpect(getLegalCols(/* [] */0, /* Draw */0, 1), /* [] */0, "getLegalCols base case");

function legalMoves(param) {
  return getLegalCols(param[0], param[1], 1);
}

CS17SetupGame$Game_new.checkExpect(legalMoves([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), {
      hd: /* Move */{
        _0: 1
      },
      tl: {
        hd: /* Move */{
          _0: 2
        },
        tl: /* [] */0
      }
    }, "legalMoves P2");

CS17SetupGame$Game_new.checkExpect(legalMoves([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ]), {
      hd: /* Move */{
        _0: 1
      },
      tl: {
        hd: /* Move */{
          _0: 2
        },
        tl: /* [] */0
      }
    }, "legalMoves P1");

CS17SetupGame$Game_new.checkExpect(legalMoves([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          /* Draw */0
        ]), /* [] */0, "legalMoves Draw");

CS17SetupGame$Game_new.checkExpect(legalMoves([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Win */0,
            _0: /* P1 */0
          }
        ]), /* [] */0, "legalMoves Win 1");

CS17SetupGame$Game_new.checkExpect(legalMoves([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Win */0,
            _0: /* P2 */1
          }
        ]), /* [] */0, "legalMoves Win 2");

CS17SetupGame$Game_new.checkExpect(legalMoves([
          /* [] */0,
          /* Draw */0
        ]), /* [] */0, "legalMoves base case");

function fourInAList(_l, _player, _streak) {
  while(true) {
    var streak = _streak;
    var player = _player;
    var l = _l;
    if (l === /* [] */0) {
      return 0;
    }
    if (List.hd(l) === player && streak === 2) {
      return player;
    }
    if (List.hd(l) === player) {
      _streak = streak + 1 | 0;
      _l = List.tl(l);
      continue ;
    }
    _streak = 0;
    _player = List.hd(l);
    _l = List.tl(l);
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(fourInAList({
          hd: 0,
          tl: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 3,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          }
        }, 0, 0), 1, "fourInAList");

CS17SetupGame$Game_new.checkExpect(fourInAList({
          hd: 0,
          tl: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          }
        }, 1, 0), 0, "fourInAList but broken-up streak");

CS17SetupGame$Game_new.checkExpect(fourInAList(/* [] */0, 1, 0), 0, "fourInAList base");

function verticals(_s) {
  while(true) {
    var s = _s;
    if (!s) {
      return "0";
    }
    var hd = s.hd;
    if (fourInAList(hd, 0, 0) !== 0) {
      return String(fourInAList(hd, 0, 0));
    }
    if (fourInAList(hd, 0, 0) !== 0) {
      return "0";
    }
    _s = s.tl;
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(verticals({
          hd: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "1", "verticals");

CS17SetupGame$Game_new.checkExpect(verticals(/* [] */0), "0", "verticals base");

CS17SetupGame$Game_new.checkExpect(verticals({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "0", "verticals split");

CS17SetupGame$Game_new.checkExpect(verticals({
          hd: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "1", "verticals order");

CS17SetupGame$Game_new.checkExpect(verticals(transpose({
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            })), "1", "horizontals");

CS17SetupGame$Game_new.checkExpect(verticals(transpose({
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    },
                    tl: {
                      hd: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: {
                            hd: 1,
                            tl: /* [] */0
                          }
                        }
                      },
                      tl: /* [] */0
                    }
                  }
                }
              }
            })), "0", "horizontals broken");

function makeDiagHoriz(l, n) {
  switch (n) {
    case 0 :
        if (l) {
          return {
                  hd: l.hd,
                  tl: makeDiagHoriz(l.tl, 1)
                };
        } else {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
    case 1 :
        if (!l) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match = l.hd;
        if (match) {
          return {
                  hd: List.flatten({
                        hd: match.tl,
                        tl: {
                          hd: {
                            hd: 0,
                            tl: /* [] */0
                          },
                          tl: /* [] */0
                        }
                      }),
                  tl: makeDiagHoriz(l.tl, 2)
                };
        } else {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
    case 2 :
        if (!l) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match$1 = l.hd;
        if (!match$1) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match$2 = match$1.tl;
        if (match$2) {
          return {
                  hd: List.flatten({
                        hd: match$2.tl,
                        tl: {
                          hd: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          },
                          tl: /* [] */0
                        }
                      }),
                  tl: makeDiagHoriz(l.tl, 3)
                };
        } else {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
    case 3 :
        if (!l) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match$3 = l.hd;
        if (!match$3) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match$4 = match$3.tl;
        if (!match$4) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match$5 = match$4.tl;
        if (match$5 && !l.tl) {
          return {
                  hd: List.flatten({
                        hd: match$5.tl,
                        tl: {
                          hd: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          },
                          tl: /* [] */0
                        }
                      }),
                  tl: /* [] */0
                };
        } else {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
    default:
      return {
              hd: /* [] */0,
              tl: /* [] */0
            };
  }
}

CS17SetupGame$Game_new.checkExpect(makeDiagHoriz({
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }, 0), {
      hd: {
        hd: 1,
        tl: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          }
        }
      },
      tl: {
        hd: {
          hd: 1,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }
      }
    }, "makeDiagHoriz");

function createListOfFours(s) {
  if (!s) {
    return /* [] */0;
  }
  var match = s.tl;
  if (!match) {
    return /* [] */0;
  }
  var match$1 = match.tl;
  if (!match$1) {
    return /* [] */0;
  }
  var match$2 = match$1.tl;
  if (!match$2) {
    return /* [] */0;
  }
  var hd4 = match$2.hd;
  var hd3 = match$1.hd;
  var hd2 = match.hd;
  return {
          hd: makeDiagHoriz({
                hd: s.hd,
                tl: {
                  hd: hd2,
                  tl: {
                    hd: hd3,
                    tl: {
                      hd: hd4,
                      tl: /* [] */0
                    }
                  }
                }
              }, 0),
          tl: createListOfFours({
                hd: hd2,
                tl: {
                  hd: hd3,
                  tl: {
                    hd: hd4,
                    tl: match$2.tl
                  }
                }
              })
        };
}

CS17SetupGame$Game_new.checkExpect(createListOfFours({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), {
      hd: {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }
      },
      tl: {
        hd: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        },
        tl: /* [] */0
      }
    }, "createListOfFours zeros");

CS17SetupGame$Game_new.checkExpect(createListOfFours({
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), {
      hd: {
        hd: {
          hd: 1,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }
      },
      tl: {
        hd: {
          hd: {
            hd: 0,
            tl: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        },
        tl: /* [] */0
      }
    }, "createListOfFours non-zero");

CS17SetupGame$Game_new.checkExpect(createListOfFours(/* [] */0), /* [] */0, "createListOfFours base");

function getDiagonals(s) {
  if (s) {
    return {
            hd: verticals(transpose(s.hd)),
            tl: getDiagonals(s.tl)
          };
  } else {
    return /* [] */0;
  }
}

CS17SetupGame$Game_new.checkExpect(getDiagonals({
          hd: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }), {
      hd: "1",
      tl: {
        hd: "0",
        tl: /* [] */0
      }
    }, "getDiagonals");

CS17SetupGame$Game_new.checkExpect(getDiagonals({
          hd: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }), {
      hd: "0",
      tl: {
        hd: "0",
        tl: /* [] */0
      }
    }, "getDiagonals 0 case");

CS17SetupGame$Game_new.checkExpect(getDiagonals(/* [] */0), /* [] */0, "getDiagonals base case");

function containsPlayerNum(_l) {
  while(true) {
    var l = _l;
    if (!l) {
      return "0";
    }
    switch (l.hd) {
      case "1" :
          return "1";
      case "2" :
          return "2";
      default:
        _l = l.tl;
        continue ;
    }
  };
}

CS17SetupGame$Game_new.checkExpect(containsPlayerNum({
          hd: "0",
          tl: {
            hd: "1",
            tl: {
              hd: "0",
              tl: /* [] */0
            }
          }
        }), "1", "containsPlayerNum 1");

CS17SetupGame$Game_new.checkExpect(containsPlayerNum({
          hd: "0",
          tl: {
            hd: "0",
            tl: {
              hd: "0",
              tl: /* [] */0
            }
          }
        }), "0", "containsPlayerNum 0");

CS17SetupGame$Game_new.checkExpect(containsPlayerNum(/* [] */0), "0", "containsPlayerNum base");

function diagonals(l) {
  if (containsPlayerNum(getDiagonals(createListOfFours(l))) === "1" || containsPlayerNum(getDiagonals(createListOfFours(List.rev(l)))) === "1") {
    return "1";
  } else if (containsPlayerNum(getDiagonals(createListOfFours(l))) === "2" || containsPlayerNum(getDiagonals(createListOfFours(List.rev(l)))) === "2") {
    return "2";
  } else {
    return "0";
  }
}

CS17SetupGame$Game_new.checkExpect(diagonals({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), "1", "diagonals");

CS17SetupGame$Game_new.checkExpect(diagonals({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), "1", "diagonals reverse");

CS17SetupGame$Game_new.checkExpect(diagonals({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: /* [] */0
                          }
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }), "0", "diagonals 3 fail");

CS17SetupGame$Game_new.checkExpect(diagonals(/* [] */0), "0", "diagonals base");

function playerCounterList(_l, n, _count) {
  while(true) {
    var count = _count;
    var l = _l;
    if (!l) {
      return count;
    }
    var tl = l.tl;
    if (l.hd === n) {
      _count = count + 1 | 0;
      _l = tl;
      continue ;
    }
    _l = tl;
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(playerCounterList({
          hd: 1,
          tl: {
            hd: 1,
            tl: {
              hd: 2,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          }
        }, 1, 0), 3, "playerCounterList");

CS17SetupGame$Game_new.checkExpect(playerCounterList(/* [] */0, 0, 0), 0, "playerCounterList base");

function playerCounterState(s, n) {
  if (s) {
    return playerCounterList(s.hd, n, 0) + playerCounterState(s.tl, n) | 0;
  } else {
    return 0;
  }
}

CS17SetupGame$Game_new.checkExpect(playerCounterState({
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }, 1), 2, "playerCounterState");

CS17SetupGame$Game_new.checkExpect(playerCounterState(/* [] */0, 1), 0, "playerCounterState base");

function gameStatus(param) {
  var b = param[0];
  if (verticals(b) === "1" || verticals(transpose(b)) === "1" || diagonals(b) === "1") {
    return {
            TAG: /* Win */0,
            _0: /* P1 */0
          };
  } else if (verticals(b) === "2" || verticals(transpose(b)) === "2" || diagonals(b) === "2") {
    return {
            TAG: /* Win */0,
            _0: /* P2 */1
          };
  } else if (playerCounterState(b, 0) === 0) {
    return /* Draw */0;
  } else if (playerCounterState(b, 2) === playerCounterState(b, 1)) {
    return {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          };
  } else if (playerCounterState(b, 2) < playerCounterState(b, 1)) {
    return {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          };
  } else {
    return /* Draw */0;
  }
}

CS17SetupGame$Game_new.checkExpect(gameStatus([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), {
      TAG: /* Win */0,
      _0: /* P1 */0
    }, "gameStatus Win(P1) Diagonal");

CS17SetupGame$Game_new.checkExpect(gameStatus([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 2,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), {
      TAG: /* Win */0,
      _0: /* P2 */1
    }, "gameStatus Win(P2) Horizontal");

CS17SetupGame$Game_new.checkExpect(gameStatus([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), {
      TAG: /* Win */0,
      _0: /* P1 */0
    }, "gameStatus Win(P1) Vertical");

CS17SetupGame$Game_new.checkExpect(gameStatus([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), /* Draw */0, "gameStatus Draw");

CS17SetupGame$Game_new.checkExpect(gameStatus([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), {
      TAG: /* Ongoing */1,
      _0: /* P2 */1
    }, "gameStatus Ongoing");

function addChip(n, l) {
  if (!l) {
    return /* [] */0;
  }
  if (l.hd !== 0) {
    return l;
  }
  var tl = l.tl;
  if (tl && tl.hd === 0) {
    return {
            hd: 0,
            tl: addChip(n, {
                  hd: 0,
                  tl: tl.tl
                })
          };
  } else {
    return {
            hd: n,
            tl: tl
          };
  }
}

CS17SetupGame$Game_new.checkExpect(addChip(1, {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          }
        }), {
      hd: 0,
      tl: {
        hd: 0,
        tl: {
          hd: 1,
          tl: {
            hd: 1,
            tl: /* [] */0
          }
        }
      }
    }, "addChip");

CS17SetupGame$Game_new.checkExpect(addChip(1, {
          hd: 2,
          tl: {
            hd: 2,
            tl: {
              hd: 2,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            }
          }
        }), {
      hd: 2,
      tl: {
        hd: 2,
        tl: {
          hd: 2,
          tl: {
            hd: 2,
            tl: /* [] */0
          }
        }
      }
    }, "addChip full");

CS17SetupGame$Game_new.checkExpect(addChip(1, /* [] */0), /* [] */0, "addChip base case");

function replaceRow(n, col, board) {
  if (board) {
    if (n !== 0) {
      return {
              hd: board.hd,
              tl: replaceRow(n - 1 | 0, col, board.tl)
            };
    } else {
      return {
              hd: col,
              tl: board.tl
            };
    }
  } else {
    return {
            hd: col,
            tl: /* [] */0
          };
  }
}

CS17SetupGame$Game_new.checkExpect(replaceRow(2, {
          hd: 2,
          tl: {
            hd: 2,
            tl: {
              hd: 2,
              tl: {
                hd: 2,
                tl: /* [] */0
              }
            }
          }
        }, {
          hd: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }), {
      hd: {
        hd: 1,
        tl: {
          hd: 1,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: /* [] */0
            }
          }
        }
      },
      tl: {
        hd: {
          hd: 1,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 2,
            tl: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }
      }
    }, "replaceRow");

CS17SetupGame$Game_new.checkExpect(replaceRow(0, /* [] */0, /* [] */0), {
      hd: /* [] */0,
      tl: /* [] */0
    }, "replaceRow base case");

function nextState(param, m) {
  var s = param[1];
  var b = param[0];
  if (typeof s === "number") {
    return [
            b,
            s
          ];
  }
  if (s.TAG === /* Win */0) {
    return [
            b,
            s
          ];
  }
  if (s._0) {
    var hd = m._0;
    var match = gameStatus([
          replaceRow(hd, addChip(2, List.nth(b, hd)), b),
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ]);
    if (typeof match === "number") {
      return [
              replaceRow(hd, addChip(2, List.nth(b, hd)), b),
              /* Draw */0
            ];
    }
    if (match.TAG === /* Win */0 && match._0) {
      return [
              replaceRow(hd, addChip(2, List.nth(b, hd)), b),
              {
                TAG: /* Win */0,
                _0: /* P2 */1
              }
            ];
    }
    return [
            replaceRow(hd, addChip(2, List.nth(b, hd)), b),
            {
              TAG: /* Ongoing */1,
              _0: /* P1 */0
            }
          ];
  }
  var hd$1 = m._0;
  var match$1 = gameStatus([
        replaceRow(hd$1, addChip(1, List.nth(b, hd$1)), b),
        {
          TAG: /* Ongoing */1,
          _0: /* P2 */1
        }
      ]);
  if (typeof match$1 === "number") {
    return [
            replaceRow(hd$1, addChip(1, List.nth(b, hd$1)), b),
            /* Draw */0
          ];
  }
  if (match$1.TAG === /* Win */0 && !match$1._0) {
    return [
            replaceRow(hd$1, addChip(1, List.nth(b, hd$1)), b),
            {
              TAG: /* Win */0,
              _0: /* P1 */0
            }
          ];
  }
  return [
          replaceRow(hd$1, addChip(1, List.nth(b, hd$1)), b),
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ];
}

CS17SetupGame$Game_new.checkExpect(nextState([
          {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ], /* Move */{
          _0: 0
        }), [
      {
        hd: {
          hd: 1,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }
      },
      {
        TAG: /* Win */0,
        _0: /* P1 */0
      }
    ], "nextState Win");

CS17SetupGame$Game_new.checkExpect(nextState([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ], /* Move */{
          _0: 0
        }), [
      {
        hd: {
          hd: 1,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }
      },
      {
        TAG: /* Win */0,
        _0: /* P1 */0
      }
    ], "nextState pre-Win");

CS17SetupGame$Game_new.checkExpect(nextState([
          {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ], /* Move */{
          _0: 1
        }), [
      {
        hd: {
          hd: 0,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }
      },
      {
        TAG: /* Ongoing */1,
        _0: /* P1 */0
      }
    ], "nextState Ongoing");

CS17SetupGame$Game_new.checkExpect(nextState([
          {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ], /* Move */{
          _0: 0
        }), [
      {
        hd: {
          hd: 2,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }
      },
      /* Draw */0
    ], "nextState Draw");

CS17SetupGame$Game_new.checkExpect(nextState([
          {
            hd: {
              hd: 2,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          /* Draw */0
        ], /* Move */{
          _0: 0
        }), [
      {
        hd: {
          hd: 2,
          tl: {
            hd: 1,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }
      },
      /* Draw */0
    ], "nextState pre-Draw");

function moveOfString(input, s) {
  var m;
  try {
    m = /* Move */{
      _0: Caml_format.caml_int_of_string(input) - 1 | 0
    };
  }
  catch (exn){
    m = Pervasives.failwith("Invalid Input");
  }
  if (!List.mem(m, legalMoves(s))) {
    Pervasives.failwith("Illegal Move");
  }
  return m;
}

CS17SetupGame$Game_new.checkExpect(moveOfString("1", [
          {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ]), /* Move */{
      _0: 0
    }, "First column legal move");

CS17SetupGame$Game_new.checkError((function (param) {
        return moveOfString("1", [
                    {
                      hd: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: {
                            hd: 1,
                            tl: {
                              hd: 1,
                              tl: /* [] */0
                            }
                          }
                        }
                      },
                      tl: {
                        hd: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        },
                        tl: {
                          hd: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: {
                                  hd: 0,
                                  tl: /* [] */0
                                }
                              }
                            }
                          },
                          tl: /* [] */0
                        }
                      }
                    },
                    {
                      TAG: /* Ongoing */1,
                      _0: /* P1 */0
                    }
                  ]);
      }), "Illegal Move");

CS17SetupGame$Game_new.checkError((function (param) {
        return moveOfString("hi", [
                    {
                      hd: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: {
                            hd: 1,
                            tl: {
                              hd: 1,
                              tl: /* [] */0
                            }
                          }
                        }
                      },
                      tl: {
                        hd: {
                          hd: 0,
                          tl: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: /* [] */0
                              }
                            }
                          }
                        },
                        tl: {
                          hd: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: {
                                hd: 0,
                                tl: {
                                  hd: 0,
                                  tl: /* [] */0
                                }
                              }
                            }
                          },
                          tl: /* [] */0
                        }
                      }
                    },
                    {
                      TAG: /* Ongoing */1,
                      _0: /* P1 */0
                    }
                  ]);
      }), "Invalid Input");

function threeInAList(_l, _player, _streak) {
  while(true) {
    var streak = _streak;
    var player = _player;
    var l = _l;
    if (l === /* [] */0) {
      return 0;
    }
    if (List.hd(l) === player && streak === 1) {
      return player;
    }
    if (List.hd(l) === player) {
      _streak = streak + 1 | 0;
      _l = List.tl(l);
      continue ;
    }
    _streak = 0;
    _player = List.hd(l);
    _l = List.tl(l);
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(threeInAList({
          hd: 0,
          tl: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 3,
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }, 0, 0), 1, "threeInAList");

CS17SetupGame$Game_new.checkExpect(threeInAList({
          hd: 0,
          tl: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            }
          }
        }, 1, 0), 0, "threeInAList but broken-up streak");

CS17SetupGame$Game_new.checkExpect(threeInAList(/* [] */0, 1, 0), 0, "threeInAList base");

function verticalsThree(_s) {
  while(true) {
    var s = _s;
    if (!s) {
      return "0";
    }
    var hd = s.hd;
    if (threeInAList(hd, 0, 0) !== 0) {
      return String(threeInAList(hd, 0, 0));
    }
    if (threeInAList(hd, 0, 0) !== 0) {
      return "0";
    }
    _s = s.tl;
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(verticalsThree({
          hd: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "1", "verticals3");

CS17SetupGame$Game_new.checkExpect(verticalsThree(/* [] */0), "0", "verticals3 base");

CS17SetupGame$Game_new.checkExpect(verticalsThree({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "0", "verticals3 split");

CS17SetupGame$Game_new.checkExpect(verticalsThree({
          hd: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "1", "verticals3 order");

CS17SetupGame$Game_new.checkExpect(verticalsThree(transpose({
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            })), "1", "horizontals3");

CS17SetupGame$Game_new.checkExpect(verticalsThree(transpose({
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: {
                    hd: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 1,
                          tl: /* [] */0
                        }
                      }
                    },
                    tl: /* [] */0
                  }
                }
              }
            })), "0", "horizontals3 broken");

function makeDiagHorizThree(l, n) {
  switch (n) {
    case 0 :
        if (l) {
          return {
                  hd: l.hd,
                  tl: makeDiagHorizThree(l.tl, 1)
                };
        } else {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
    case 1 :
        if (!l) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match = l.hd;
        if (match) {
          return {
                  hd: List.flatten({
                        hd: match.tl,
                        tl: {
                          hd: {
                            hd: 0,
                            tl: /* [] */0
                          },
                          tl: /* [] */0
                        }
                      }),
                  tl: makeDiagHorizThree(l.tl, 2)
                };
        } else {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
    case 2 :
        if (!l) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match$1 = l.hd;
        if (!match$1) {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
        var match$2 = match$1.tl;
        if (match$2) {
          return {
                  hd: List.flatten({
                        hd: match$2.tl,
                        tl: {
                          hd: {
                            hd: 0,
                            tl: {
                              hd: 0,
                              tl: /* [] */0
                            }
                          },
                          tl: /* [] */0
                        }
                      }),
                  tl: /* [] */0
                };
        } else {
          return {
                  hd: /* [] */0,
                  tl: /* [] */0
                };
        }
    default:
      return {
              hd: /* [] */0,
              tl: /* [] */0
            };
  }
}

CS17SetupGame$Game_new.checkExpect(makeDiagHorizThree({
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }, 0), {
      hd: {
        hd: 1,
        tl: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          }
        }
      },
      tl: {
        hd: {
          hd: 1,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: /* [] */0
        }
      }
    }, "makeDiagHoriz3");

function createListOfThrees(s) {
  if (!s) {
    return /* [] */0;
  }
  var match = s.tl;
  if (!match) {
    return /* [] */0;
  }
  var match$1 = match.tl;
  if (!match$1) {
    return /* [] */0;
  }
  var hd3 = match$1.hd;
  var hd2 = match.hd;
  return {
          hd: makeDiagHorizThree({
                hd: s.hd,
                tl: {
                  hd: hd2,
                  tl: {
                    hd: hd3,
                    tl: /* [] */0
                  }
                }
              }, 0),
          tl: createListOfThrees({
                hd: hd2,
                tl: {
                  hd: hd3,
                  tl: match$1.tl
                }
              })
        };
}

CS17SetupGame$Game_new.checkExpect(createListOfThrees({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }), {
      hd: {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: /* [] */0
          }
        }
      },
      tl: {
        hd: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: /* [] */0
            }
          }
        },
        tl: /* [] */0
      }
    }, "createListOf3s zeros");

CS17SetupGame$Game_new.checkExpect(createListOfThrees({
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }), {
      hd: {
        hd: {
          hd: 1,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          }
        },
        tl: {
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: /* [] */0
          }
        }
      },
      tl: {
        hd: {
          hd: {
            hd: 0,
            tl: {
              hd: 1,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: /* [] */0
            }
          }
        },
        tl: /* [] */0
      }
    }, "createListOf3s non-zero");

CS17SetupGame$Game_new.checkExpect(createListOfThrees(/* [] */0), /* [] */0, "createListOf3s base");

function getDiagonalsThree(s) {
  if (s) {
    return {
            hd: verticalsThree(transpose(s.hd)),
            tl: getDiagonalsThree(s.tl)
          };
  } else {
    return /* [] */0;
  }
}

CS17SetupGame$Game_new.checkExpect(getDiagonalsThree({
          hd: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            },
            tl: /* [] */0
          }
        }), {
      hd: "1",
      tl: {
        hd: "0",
        tl: /* [] */0
      }
    }, "getDiagonals3");

CS17SetupGame$Game_new.checkExpect(getDiagonalsThree({
          hd: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            },
            tl: /* [] */0
          }
        }), {
      hd: "0",
      tl: {
        hd: "0",
        tl: /* [] */0
      }
    }, "getDiagonals3 0 case");

CS17SetupGame$Game_new.checkExpect(getDiagonalsThree(/* [] */0), /* [] */0, "getDiagonals3 base case");

function diagonalsThree(l) {
  if (containsPlayerNum(getDiagonalsThree(createListOfThrees(l))) === "1" || containsPlayerNum(getDiagonalsThree(createListOfThrees(List.rev(l)))) === "1") {
    return "1";
  } else if (containsPlayerNum(getDiagonalsThree(createListOfThrees(l))) === "2" || containsPlayerNum(getDiagonalsThree(createListOfThrees(List.rev(l)))) === "2") {
    return "2";
  } else {
    return "0";
  }
}

CS17SetupGame$Game_new.checkExpect(diagonalsThree({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), "1", "diagonals3");

CS17SetupGame$Game_new.checkExpect(diagonalsThree({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), "1", "diagonals3 reverse");

CS17SetupGame$Game_new.checkExpect(diagonalsThree({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }), "0", "diagonals3 2 fail");

CS17SetupGame$Game_new.checkExpect(diagonalsThree(/* [] */0), "0", "diagonals3 base");

function threeStatus(b, n) {
  if (verticalsThree(b) === String(n) || verticalsThree(transpose(b)) === String(n) || diagonalsThree(b) === String(n)) {
    return n;
  } else {
    return 0;
  }
}

CS17SetupGame$Game_new.checkExpect(threeStatus({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1), 1, "3stat diag");

CS17SetupGame$Game_new.checkExpect(threeStatus({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1), 1, "3stat vert");

CS17SetupGame$Game_new.checkExpect(threeStatus({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1), 1, "3stat horiz");

CS17SetupGame$Game_new.checkExpect(threeStatus({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1), 0, "3stat fail");

CS17SetupGame$Game_new.checkError((function (param) {
        return threeStatus(/* [] */0, 1);
      }), "A board cannot be 0 - dimensional.");

function twoInAList(_l, _player, _streak) {
  while(true) {
    var streak = _streak;
    var player = _player;
    var l = _l;
    if (l === /* [] */0) {
      return 0;
    }
    if (List.hd(l) === player && streak === 0) {
      return player;
    }
    if (List.hd(l) === player) {
      _streak = streak + 1 | 0;
      _l = List.tl(l);
      continue ;
    }
    _streak = 0;
    _player = List.hd(l);
    _l = List.tl(l);
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(twoInAList({
          hd: 0,
          tl: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 3,
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1, 0), 1, "twoInAList");

CS17SetupGame$Game_new.checkExpect(twoInAList({
          hd: 0,
          tl: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1, 0), 0, "twoInAList but broken-up streak");

CS17SetupGame$Game_new.checkExpect(twoInAList(/* [] */0, 1, 0), 0, "twoInAList base");

function verticalsTwo(_s) {
  while(true) {
    var s = _s;
    if (!s) {
      return "0";
    }
    var hd = s.hd;
    if (twoInAList(hd, 0, 0) !== 0) {
      return String(twoInAList(hd, 0, 0));
    }
    if (twoInAList(hd, 0, 0) !== 0) {
      return "0";
    }
    _s = s.tl;
    continue ;
  };
}

CS17SetupGame$Game_new.checkExpect(verticalsTwo({
          hd: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "1", "verticals2");

CS17SetupGame$Game_new.checkExpect(verticalsTwo(/* [] */0), "0", "verticals2 base");

CS17SetupGame$Game_new.checkExpect(verticalsTwo({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 2,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "0", "verticals2 split");

CS17SetupGame$Game_new.checkExpect(verticalsTwo({
          hd: {
            hd: 2,
            tl: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: /* [] */0
            }
          }
        }), "1", "verticals2 order");

CS17SetupGame$Game_new.checkExpect(verticalsTwo(transpose({
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            })), "1", "horizontals2");

CS17SetupGame$Game_new.checkExpect(verticalsTwo(transpose({
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            })), "0", "horizontals2 broken");

function makeDiagHorizTwo(l, n) {
  if (n === 0) {
    if (l) {
      return {
              hd: l.hd,
              tl: makeDiagHorizTwo(l.tl, 1)
            };
    } else {
      return {
              hd: /* [] */0,
              tl: /* [] */0
            };
    }
  }
  if (n !== 1) {
    return {
            hd: /* [] */0,
            tl: /* [] */0
          };
  }
  if (!l) {
    return {
            hd: /* [] */0,
            tl: /* [] */0
          };
  }
  var match = l.hd;
  if (match) {
    return {
            hd: List.flatten({
                  hd: match.tl,
                  tl: {
                    hd: {
                      hd: 0,
                      tl: /* [] */0
                    },
                    tl: /* [] */0
                  }
                }),
            tl: /* [] */0
          };
  } else {
    return {
            hd: /* [] */0,
            tl: /* [] */0
          };
  }
}

CS17SetupGame$Game_new.checkExpect(makeDiagHorizTwo({
          hd: {
            hd: 1,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: /* [] */0
          }
        }, 0), {
      hd: {
        hd: 1,
        tl: {
          hd: 0,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          }
        }
      },
      tl: {
        hd: {
          hd: 1,
          tl: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          }
        },
        tl: /* [] */0
      }
    }, "makeDiagHoriz2");

function createListOfTwos(s) {
  if (!s) {
    return /* [] */0;
  }
  var match = s.tl;
  if (!match) {
    return /* [] */0;
  }
  var hd2 = match.hd;
  return {
          hd: makeDiagHorizTwo({
                hd: s.hd,
                tl: {
                  hd: hd2,
                  tl: /* [] */0
                }
              }, 0),
          tl: createListOfTwos({
                hd: hd2,
                tl: match.tl
              })
        };
}

CS17SetupGame$Game_new.checkExpect(createListOfTwos({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              },
              tl: /* [] */0
            }
          }
        }), {
      hd: {
        hd: {
          hd: 0,
          tl: {
            hd: 0,
            tl: /* [] */0
          }
        },
        tl: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          },
          tl: /* [] */0
        }
      },
      tl: {
        hd: {
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            },
            tl: /* [] */0
          }
        },
        tl: /* [] */0
      }
    }, "createListOf2s");

CS17SetupGame$Game_new.checkExpect(createListOfTwos(/* [] */0), /* [] */0, "createListOf2s base");

function getDiagonalsTwo(s) {
  if (s) {
    return {
            hd: verticalsTwo(transpose(s.hd)),
            tl: getDiagonalsTwo(s.tl)
          };
  } else {
    return /* [] */0;
  }
}

CS17SetupGame$Game_new.checkExpect(getDiagonalsTwo({
          hd: {
            hd: {
              hd: 0,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              },
              tl: /* [] */0
            }
          },
          tl: {
            hd: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            },
            tl: /* [] */0
          }
        }), {
      hd: "1",
      tl: {
        hd: "0",
        tl: /* [] */0
      }
    }, "getDiagonals2");

CS17SetupGame$Game_new.checkExpect(getDiagonalsTwo({
          hd: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            },
            tl: /* [] */0
          }
        }), {
      hd: "0",
      tl: {
        hd: "0",
        tl: /* [] */0
      }
    }, "getDiagonals2 0 case");

CS17SetupGame$Game_new.checkExpect(getDiagonalsTwo(/* [] */0), /* [] */0, "getDiagonals2 base case");

function diagonalsTwo(l) {
  if (containsPlayerNum(getDiagonalsTwo(createListOfTwos(l))) === "1" || containsPlayerNum(getDiagonalsTwo(createListOfTwos(List.rev(l)))) === "1") {
    return "1";
  } else if (containsPlayerNum(getDiagonalsTwo(createListOfTwos(l))) === "2" || containsPlayerNum(getDiagonalsTwo(createListOfTwos(List.rev(l)))) === "2") {
    return "2";
  } else {
    return "0";
  }
}

CS17SetupGame$Game_new.checkExpect(diagonalsTwo({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), "1", "diagonals3");

CS17SetupGame$Game_new.checkExpect(diagonalsTwo({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }), "1", "diagonals3 reverse");

CS17SetupGame$Game_new.checkExpect(diagonalsTwo({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: /* [] */0
              }
            }
          }
        }), "0", "diagonals3 2 fail");

CS17SetupGame$Game_new.checkExpect(diagonalsTwo(/* [] */0), "0", "diagonals3 base");

function twoStatus(b, n) {
  if (verticalsTwo(b) === String(n) || verticalsTwo(transpose(b)) === String(n) || diagonalsTwo(b) === String(n)) {
    return n;
  } else {
    return 0;
  }
}

CS17SetupGame$Game_new.checkExpect(twoStatus({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1), 1, "2stat diag");

CS17SetupGame$Game_new.checkExpect(twoStatus({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1), 1, "2stat vert");

CS17SetupGame$Game_new.checkExpect(twoStatus({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1), 1, "2stat horiz");

CS17SetupGame$Game_new.checkExpect(twoStatus({
          hd: {
            hd: 0,
            tl: {
              hd: 0,
              tl: {
                hd: 0,
                tl: /* [] */0
              }
            }
          },
          tl: {
            hd: {
              hd: 0,
              tl: {
                hd: 0,
                tl: {
                  hd: 1,
                  tl: /* [] */0
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: /* [] */0
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          }
        }, 1), 0, "2stat fail");

function estimateValue(param) {
  var s = param[1];
  var b = param[0];
  if (typeof s === "number") {
    return 0.0;
  } else if (s.TAG === /* Win */0) {
    if (s._0) {
      return -1234567891234.0;
    } else {
      return 1234567891234.0;
    }
  } else if (s._0) {
    if (threeStatus(b, 2) === 2) {
      return -123456789.0;
    } else if (twoStatus(b, 2) === 2) {
      if (threeStatus(b, 1) === 1) {
        return 12.0;
      } else if (twoStatus(b, 1) === 1) {
        return -12.0;
      } else {
        return -12345.0;
      }
    } else if (threeStatus(b, 1) === 1) {
      return 1234567.0;
    } else if (twoStatus(b, 1) === 1) {
      return 12.0;
    } else {
      return -12.0;
    }
  } else if (threeStatus(b, 1) === 1) {
    return 123456789.0;
  } else if (twoStatus(b, 1) === 1) {
    if (threeStatus(b, 2) === 2) {
      return -12.0;
    } else if (twoStatus(b, 2) === 2) {
      return 12.0;
    } else {
      return 12345.0;
    }
  } else if (threeStatus(b, 2) === 2) {
    return -1234567.0;
  } else if (twoStatus(b, 2) === 2) {
    return -12.0;
  } else {
    return 12.0;
  }
}

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Win */0,
            _0: /* P1 */0
          }
        ]), 1234567891234.0, "estimateValue Win(P1)");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Win */0,
            _0: /* P2 */1
          }
        ]), -1234567891234.0, "estimateValue Win(P1)");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Win */0,
            _0: /* P1 */0
          }
        ]), 1234567891234.0, "estimateValue Win Order");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ]), 123456789.0, "estimateValue three P1");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ]), 12345.0, "estimateValue two P1");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ]), -1234567.0, "estimateValue threeP2 for P1");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P1 */0
          }
        ]), -12.0, "estimateValue twoP2 for P1");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 2,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), -123456789.0, "estimateValue three P2");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 2,
              tl: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), -12.0, "estimateValue two P2");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 2,
                tl: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 1,
                  tl: {
                    hd: 2,
                    tl: {
                      hd: 1,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), 1234567.0, "estimateValue threeP1 for P2");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 1,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 0,
                tl: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 0,
                  tl: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 2,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 0,
                    tl: {
                      hd: 0,
                      tl: {
                        hd: 0,
                        tl: {
                          hd: 0,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          {
            TAG: /* Ongoing */1,
            _0: /* P2 */1
          }
        ]), 12.0, "estimateValue twoP1 for P2");

CS17SetupGame$Game_new.checkExpect(estimateValue([
          {
            hd: {
              hd: 1,
              tl: {
                hd: 2,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 2,
                    tl: /* [] */0
                  }
                }
              }
            },
            tl: {
              hd: {
                hd: 1,
                tl: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: /* [] */0
                    }
                  }
                }
              },
              tl: {
                hd: {
                  hd: 2,
                  tl: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: /* [] */0
                      }
                    }
                  }
                },
                tl: {
                  hd: {
                    hd: 1,
                    tl: {
                      hd: 2,
                      tl: {
                        hd: 1,
                        tl: {
                          hd: 2,
                          tl: /* [] */0
                        }
                      }
                    }
                  },
                  tl: /* [] */0
                }
              }
            }
          },
          /* Draw */0
        ]), 0.0, "estimateValue Draw");

var Connect4 = {
  stringOfPlayer: stringOfPlayer,
  stringOfState: stringOfState,
  stringOfMove: stringOfMove,
  initialState: initialState,
  legalMoves: legalMoves,
  gameStatus: gameStatus,
  nextState: nextState,
  moveOfString: moveOfString,
  estimateValue: estimateValue
};

exports.Connect4 = Connect4;
/*  Not a pure module */
